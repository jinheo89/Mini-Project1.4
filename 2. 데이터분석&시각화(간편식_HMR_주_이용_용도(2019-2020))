setwd("C:/workspace/R_basic/pjt1.4")

data2<-read.csv("간편식_HMR__주_이용_용도_(2019-2020).csv", header=TRUE)

#2019년 간편식 종류 colname
data2[c(1,2),c(3:17)]
#2020년 간편식 종류 colname
data2[c(1,2),c(18:32)]

#2019년 1인가구 간편식 이용 비율
data2[10,c(3:17)]
#2020년 1인가구 간편식 이용 비율
data2[10,c(18:32)]

#즉석조리식품
mt2.11<-as.vector(as.matrix(data2[10,c(3:7)]))
mt2.21<-as.vector(as.matrix(data2[10,c(18:22)]))

library(ggplot2)
#install.packages("gridExtra")
library(gridExtra)

#piechart 시각화
df1<-data.frame("Purpose"=c("식사대용","간식용","안주용","캠핑/여행용","기타"),
              "share"=as.numeric(mt2.11))

p1<-ggplot(df1, aes(x="", y=share, fill=Purpose))+geom_bar(width=1, stat="identity")+coord_polar("y")+
  geom_text(aes(label = paste0(share,"%")), position = position_stack(vjust = 0.5), angle = c(-90, -90, 0, -90)) + 
  labs(title="2019년 1인가구 즉석조리식품 이용 비율")

df2<-data.frame("Purpose"=c("식사대용","간식용","안주용","캠핑/여행용","기타"),
                "share"=as.numeric(mt2.21))

p2<-ggplot(df2, aes(x="", y=share, fill=Purpose))+geom_bar(width=1, stat="identity")+coord_polar("y")+
  geom_text(aes(label = paste0(share,"%")), position = position_stack(vjust = 0.5), angle=c(-97,-110,0,-70))+ 
    labs(title="2020년 1인가구 즉석조리식품 이용 비율")

grid.arrange(p1,p2,ncol=2)



#즉석섭취식품
mt2.12<-as.vector(as.matrix(data2[10,c(8:12)]))
mt2.22<-as.vector(as.matrix(data2[10,c(23:27)]))

#piechart 시각화
df3<-data.frame("Purpose"=c("식사대용","간식용","안주용","캠핑/여행용","기타"),
                "share"=as.numeric(mt2.12))

p3<-ggplot(df3, aes(x="", y=share, fill=Purpose))+geom_bar(width=1, stat="identity")+coord_polar("y")+
  geom_text(aes(label = paste0(share,"%")), position = position_stack(vjust = 0.5))+ 
    labs(title="2019년 1인가구 즉석섭취식품 이용 비율")

df4<-data.frame("Purpose"=c("식사대용","간식용","안주용","캠핑/여행용","기타"),
                "share"=as.numeric(mt2.22))

p4<-ggplot(df4, aes(x="", y=share, fill=Purpose))+geom_bar(width=1, stat="identity")+coord_polar("y")+
  geom_text(aes(label = paste0(share,"%")), position = position_stack(vjust = 0.5))+ 
   labs(title="2020년 1인가구 즉석섭취식품 이용 비율")

grid.arrange(p3,p4,ncol=2)

#신선편의식품
mt2.13<-as.vector(as.matrix(data2[10,c(13:17)]))
mt2.23<-as.vector(as.matrix(data2[10,c(28:32)]))

#piechart 시각화
df4<-data.frame("Purpose"=c("식사대용","간식용","안주용","캠핑/여행용","기타"),
                "share"=as.numeric(mt2.12))

p4<-ggplot(df4, aes(x="", y=share, fill=Purpose))+geom_bar(width=1, stat="identity")+coord_polar("y")+
  geom_text(aes(label = paste0(share,"%")), position = position_stack(vjust = 0.5))+ 
  labs(title="2019년 1인가구 신선편의식품 이용 비율")

df5<-data.frame("Purpose"=c("식사대용","간식용","안주용","캠핑/여행용","기타"),
                "share"=as.numeric(mt2.22))

p5<-ggplot(df5, aes(x="", y=share, fill=Purpose))+geom_bar(width=1, stat="identity")+coord_polar("y")+
  geom_text(aes(label = paste0(share,"%")), position = position_stack(vjust = 0.5))+ 
  labs(title="2020년 1인가구 신선편의식품 이용 비율")

grid.arrange(p4,p5,ncol=2)


#분석내용: 코로나 이후 즉석조리식품의 식사대용 이용비율이 증가하였고, 즉석조리 식품, 즉석 섭취식품, 신선편의식품에서 식사대용이 차지하는 비중이 가장 컸다.
#1인가구의 간편식 이용은 주로 식사대용으로 주로 이루어지고 있고, 그 다음으로 높은 비율은 간식용이였다.
#신선편의 식품의 경우 코로나 이후 식사대용은 비율은 감소했으나 간식용의 비중은 증가했다.
